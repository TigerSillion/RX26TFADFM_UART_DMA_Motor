# Change Records

## Record 2026-02-16-25
- Date: 2026-02-16
- Executor: Codex
- Scope: 新增电机现场排障“一页纸速查版”并同步文档日志
- Related files:
  - `docs/MOTOR_CONTROL_QUICK_DEBUG_CN.md`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - 用户要求继续补充文档，并在完成后更新到 GitHub；需提供更适合现场快速定位的简版排障指南。
- Implementation summary:
  - 新增 `docs/MOTOR_CONTROL_QUICK_DEBUG_CN.md`：
    - 15 个必看变量（模式/采样/启动门槛）
    - 10 分钟分步排障路径
    - 症状-根因快速判定表
    - 当前工程默认阈值与最短观测序列
  - 在 `CHANGELOG.md` 的 `Added (Documentation)` 小节追加该速查版说明。
- Risk assessment:
  - Low: 文档更新，不涉及固件功能与构建链改动。
- Validation evidence:
  - 2026-02-16 17:59:32 +08:00:
    - `Get-Date -Format "yyyy-MM-dd HH:mm:ss K"` -> `2026-02-16 17:59:32 +08:00`
  - 2026-02-16 18:00 +08:00:
    - `rg -n "# RX26T 电机不转一页纸速查（10 分钟版）|## 2\\. 10 分钟排障路径|## 3\\. 快速判定表" docs/MOTOR_CONTROL_QUICK_DEBUG_CN.md` -> PASS（命中核心章节）
    - `rg -n "MOTOR_CONTROL_QUICK_DEBUG_CN\\.md|Quick handbook content includes|one-page quick-debug" CHANGELOG.md` -> PASS（命中日志条目）
    - `Get-Item docs/MOTOR_CONTROL_QUICK_DEBUG_CN.md | Select-Object FullName,Length,LastWriteTime` -> PASS（文件存在且时间戳更新）

## Record 2026-02-16-24
- Date: 2026-02-16
- Executor: Codex
- Scope: 电机控制详细中文设计/排障文档补充（结构图 + 全局变量 + 流程图 + 不转定位步骤）
- Related files:
  - `docs/MOTOR_CONTROL_DETAILED_GUIDE_CN.md`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - 用户要求提供一份完整中文说明文档，重点覆盖电机部分的软件结构图、全局变量解释、流程图，以及“电机不转”时按变量逐步定位问题的方法。
- Implementation summary:
  - 新增 `docs/MOTOR_CONTROL_DETAILED_GUIDE_CN.md`，内容包含：
    - 电机软件分层结构图（入口/系统管理/算法/驱动/外设）
    - 主循环流程图与中断流程图（S12AD0/CMT0/POE）
    - 顶层状态机与 RUN 内子状态说明
    - 关键全局变量说明（ICS 可观测 + 深度 watch 变量）
    - `u2_error_status` 错误位解码表
    - 默认关键参数与阈值（周期、保护、电机参数）
    - “电机不转”逐步排障流程与步骤化检查表
  - 在 `CHANGELOG.md` 增加 `Added (Documentation)` 条目并登记文档新增内容。
- Risk assessment:
  - Low: 本次变更为文档更新，不改动固件逻辑与构建配置。
- Validation evidence:
  - 2026-02-16 17:36:37 +08:00:
    - `Get-Date -Format "yyyy-MM-dd HH:mm:ss K"` -> `2026-02-16 17:36:37 +08:00`
  - 2026-02-16 17:37 +08:00:
    - `rg -n "# RX26T 电机控制代码详解与排障手册（中文）|## 9\\. 电机不转排障流程|## 10\\. 推荐 Watch 变量清单" docs/MOTOR_CONTROL_DETAILED_GUIDE_CN.md` -> PASS（命中 3 处核心章节）
    - `rg -n "MOTOR_CONTROL_DETAILED_GUIDE_CN\\.md|Added \\(Documentation\\)" CHANGELOG.md` -> PASS（命中 changelog 记录）
    - `Get-Item docs/MOTOR_CONTROL_DETAILED_GUIDE_CN.md | Select-Object FullName,Length,LastWriteTime` -> PASS（文件存在且时间戳更新）

## Record 2026-02-16-23
- Date: 2026-02-16
- Executor: Codex
- Scope: Build metadata convergence fix for `clean build` stability (single entry + single motor-driver implementation)
- Related files:
  - `.cproject`
  - `RX26TFADFM_UART_DMA_Motor.rcpc`
  - `HardwareDebug/src/subdir.mk`
  - `HardwareDebug/src/app/mcu/rx26t/subdir.mk`
  - `HardwareDebug/LinkerRX26TFADFM_UART_DMA_Motor.tmp`
  - `HardwareDebug/LibraryGeneratorRX26TFADFM_UART_DMA_Motor.tmp`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - `make clean && make all` still reintroduced and linked stale legacy objects (`RX26TFADFM_UART_DMA_Motor.obj`, `r_motor_driver_smc.obj`) due drift in `rcpc/HardwareDebug` metadata.
- Fix summary:
  - Added source-level exclusion in `.cproject`:
    - `RX26TFADFM_UART_DMA_Motor.c`
    - `app/mcu/rx26t/r_motor_driver_smc.c`
  - Removed legacy source entries from `RX26TFADFM_UART_DMA_Motor.rcpc`:
    - `src\RX26TFADFM_UART_DMA_Motor.c`
    - `src\app\mcu\rx26t\r_motor_driver_smc.c`
  - Removed legacy object entries from `RX26TFADFM_UART_DMA_Motor.rcpc` link order:
    - `HardwareDebug\RX26TFADFM_UART_DMA_Motor.obj`
    - `HardwareDebug\r_motor_driver_smc.obj`
  - Updated `HardwareDebug/src/subdir.mk` and `HardwareDebug/src/app/mcu/rx26t/subdir.mk` to active source set only.
  - Updated `HardwareDebug/LinkerRX26TFADFM_UART_DMA_Motor.tmp` to remove stale legacy object inputs.
  - Updated library head to include `math` in:
    - `RX26TFADFM_UART_DMA_Motor.rcpc`
    - `HardwareDebug/LibraryGeneratorRX26TFADFM_UART_DMA_Motor.tmp`
- Risk assessment:
  - Low: configuration-only fix; no functional logic change.
  - Medium: `HardwareDebug/*.tmp` are generated artifacts and may be overwritten if project generation settings are changed again.
- Validation evidence:
  - 2026-02-16 16:44 +08:00:
    - `make clean; make -j8 all` -> FAIL
    - Key log: `F0563300:Cannot open file : ".\src\app\mcu\rx26t\r_motor_driver_smc.obj"`
  - 2026-02-16 16:49 +08:00:
    - `make clean; make -j8 all` -> PASS (`Build complete.`)
  - Post-check:
    - `rg -n "RX26TFADFM_UART_DMA_Motor\.obj|r_motor_driver_smc\.obj" HardwareDebug/LinkerRX26TFADFM_UART_DMA_Motor.tmp` -> no match
    - `Select-String ... RX26TFADFM_UART_DMA_Motor.rcpc` for legacy source/object entries -> no match

## Record 2026-02-16-17
- Date: 2026-02-16
- Executor: Codex
- Scope: RX26T motor-control merge to MTU3/4 baseline + UART-DMA non-blocking integration
- Related files:
  - `.cproject`
  - `RX26TFADFM_UART_DMA_Motor.rcpc`
  - `HardwareDebug/src/subdir.mk`
  - `HardwareDebug/src/app/mcu/rx26t/subdir.mk`
  - `HardwareDebug/LinkerRX26TFADFM_UART_DMA_Motor.tmp`
  - `HardwareDebug/LibraryGeneratorRX26TFADFM_UART_DMA_Motor.tmp`
  - `src/app/mcu/rx26t/r_app_mcu.c`
  - `src/app/motor_module/Config_MOTOR/Config_MOTOR.h`
  - `src/app/motor_module/Config_MOTOR/Config_MOTOR.c`
  - `src/app/motor_module/Config_MOTOR/Config_MOTOR_user.c`
  - `src/smc_gen/Config_S12AD0/Config_S12AD0_user.c`
  - `src/smc_gen/Config_CMT0/Config_CMT0_user.c`
  - `src/smc_gen/Config_POE/Config_POE_user.c`
  - `src/app/uart_dma/uart_dma_demo.h`
  - `src/app/uart_dma/uart_dma_demo.c`
  - `src/app/main/mtr_main.c`
  - `src/app/user_interface/ics/ICS2_RX26T.c`
  - `docs/MOTOR_PORTING_MAP.md`
  - `docs/SMC_GEN_MODIFICATIONS.md`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - Resolve dual-main and dual-motor-driver conflicts, align HAL to `POE/S12AD0`, wire SMC user ISRs to motor interrupts, and merge UART-DMA into motor main loop in non-blocking mode.
- Risk assessment:
  - Medium: UART autosweep interval semantics changed from blocking delay to poll-driven scheduling.
  - Medium: linker section layout updated with `BDTCTBL`, requires e2studio config continuity.
  - Low: SMC modifications are limited to user code blocks only.
- Validation evidence:
  - 2026-02-16 16:14 +08:00: single-file compile using CCRX subcommand (pass set):
    - `C:\CS+8.13\CS+\CC\CC-RX\V3.07.00\bin\ccrx.exe -subcommand="HardwareDebug/src/app/mcu/rx26t/cSubCommand.tmp" src/app/mcu/rx26t/r_app_mcu.c` -> PASS
    - `... -subcommand="HardwareDebug/src/app/motor_module/Config_MOTOR/cSubCommand.tmp" src/app/motor_module/Config_MOTOR/Config_MOTOR.c` -> FAIL (`_20_MTR_MTU_OLS3N_HL` undefined), then fixed macro usage and re-run -> PASS
    - `... Config_MOTOR_user.c` -> PASS
    - `... mtr_main.c` -> PASS
    - `... uart_dma_demo.c` -> PASS
    - `... Config_S12AD0_user.c` -> PASS
    - `... Config_CMT0_user.c` -> PASS
    - `... Config_POE_user.c` -> PASS
  - 2026-02-16 16:20 +08:00: full build
    - `make all` (with CCRX bin in PATH) -> FAIL (undefined math symbols + `___asm`)
  - 2026-02-16 16:24 +08:00: rebuild after fixes
    - `make clean; make all` -> FAIL (`BDTCTBL` section address not assigned)
  - 2026-02-16 16:28 +08:00: rebuild after linker section update
    - `make all` -> FAIL (`renesas_cc_converter` not found in PATH)
  - 2026-02-16 16:30 +08:00: final full build
    - `make all` with PATH including:
      - `C:\CS+8.13\CS+\CC\CC-RX\V3.07.00\bin`
      - `C:\Renesas\e2_studio_v6.2.0\Utilities\ccrx`
    - Result -> PASS (`Build complete.`)
- Verification summary:
  - No active build of `src/RX26TFADFM_UART_DMA_Motor.c`.
  - No active build of `src/app/mcu/rx26t/r_motor_driver_smc.c`.
  - Link no longer reports `multiple definition of main` or `multiple definition of R_Config_MOTOR_*`.
  - UART-DMA merged as non-blocking service in motor main path (`mtr_init` + `mtr_main`).

## Record 2026-02-14-01
- Date: 2026-02-14
- Executor: Codex
- Scope: RX26T UART-DMA MVP + AGENT/MCP/SKILL/rules governance
- Related files:
  - `src/RX26TFADFM_UART_DMA_Motor.c`
  - `src/app/common/app_types.h`
  - `src/app/uart_dma/uart_dma_port.h`
  - `src/app/uart_dma/uart_dma_port.c`
  - `src/app/uart_dma/uart_dma_demo.h`
  - `src/app/uart_dma/uart_dma_demo.c`
  - `src/smc_gen/Config_SCI5/Config_SCI5_user.c`
  - `src/smc_gen/Config_DMAC0/Config_DMAC0_user.c`
  - `src/smc_gen/Config_DMAC1/Config_DMAC1_user.c`
  - `src/smc_gen/general/r_cg_userdefine.h`
  - `AGENTS.md`
  - `.codex/config.toml`
  - `.codex/rules/*`
  - `.codex/skills/rx-uart-mvp/*`
  - `.agents/skills/*`
  - `docs/*`
  - `CHANGELOG.md`
- Reason:
  - Implement UART-DMA minimum closed-loop with strict SMC-safe modifications.
  - Establish mandatory engineering logging and rule constraints.
- Risk assessment:
  - Medium: UART TX path is byte-wise DMAC software trigger, may limit throughput.
  - Low: SMC overwrite risk controlled by user-region-only edits and documentation.
- Validation evidence:
  - 2026-02-14: `ccrx -isa=rxv3 ... src/RX26TFADFM_UART_DMA_Motor.c` -> PASS
  - 2026-02-14: `ccrx -isa=rxv3 ... src/app/uart_dma/uart_dma_port.c` -> PASS
  - 2026-02-14: `ccrx -isa=rxv3 ... src/app/uart_dma/uart_dma_demo.c` -> PASS
  - 2026-02-14: `ccrx -isa=rxv3 ... src/smc_gen/Config_DMAC0/Config_DMAC0_user.c` -> PASS
  - 2026-02-14: `ccrx -isa=rxv3 ... src/smc_gen/Config_DMAC1/Config_DMAC1_user.c` -> PASS
  - 2026-02-14: `ccrx -isa=rxv3 ... src/smc_gen/Config_SCI5/Config_SCI5_user.c` -> PASS
- Open items:
  - Full target build/link and on-board 10,000-byte stress test pending in e2studio environment.

## Record 2026-02-14-02
- Date: 2026-02-14
- Executor: Codex
- Scope: Documentation encoding repair
- Related files:
  - `docs/SMC_GEN_MODIFICATIONS.md`
  - `docs/MIDDLEWARE_FLOW_UART_DMA.md`
  - `docs/ENGINEERING_RULES.md`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - Previous document write used incompatible encoding and produced garbled Chinese text.
- Risk assessment:
  - Low: documentation-only change, no source code behavior impact.
- Validation evidence:
  - 2026-02-14: opened each target document and verified readable Chinese content.
  - 2026-02-14: `rg -n "\\?\\?\\?|\\?" docs -S` -> no garbled marker found.

## Record 2026-02-14-03
- Date: 2026-02-14
- Executor: Codex
- Scope: UART functional test optimization and test interface
- Related files:
  - `src/app/common/app_types.h`
  - `src/app/uart_dma/uart_dma_port.h`
  - `src/app/uart_dma/uart_dma_port.c`
  - `src/app/uart_dma/uart_dma_demo.c`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - User reported functional test anomalies and requested optimization or a simple validation interface.
- Risk assessment:
  - Medium: additional command processing in demo loop; possible behavior change if host previously relied on raw echo only.
  - Low: no change in `smc_gen` generated logic.
- Validation evidence:
  - 2026-02-14: `ccrx ... src/app/uart_dma/uart_dma_port.c` -> PASS
  - 2026-02-14: `ccrx ... src/app/uart_dma/uart_dma_demo.c` -> PASS
  - 2026-02-14: `ccrx ... src/app/common/app_types.h` -> PASS
- Test instructions:
  - Open serial tool, reset board, send `h` to get command list.
  - Send `s` to read counters.
  - Send `t` to verify test token output.
  - Send `b` to run 256-byte burst TX and check `tx_timeout_count` remains 0.

## Record 2026-02-14-04
- Date: 2026-02-14
- Executor: Codex
- Scope: Desktop GUI UART upper-rate test tool
- Related files:
  - `tools/UartRateTester/uart_rate_tester.py`
  - `tools/UartRateTester/README.md`
  - `tools/UartRateTester/run_uart_rate_tester.bat`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - User requested a simple GUI for self-test and baud-rate upper-limit scan.
- Risk assessment:
  - Low: host-side tool only, no MCU firmware behavior change.
- Validation evidence:
  - 2026-02-14: `python -m py_compile tools/UartRateTester/uart_rate_tester.py` -> PASS
  - 2026-02-14: README content check -> PASS
- Usage summary:
  - Select COM port and candidate baud list.
  - Click `Start Scan`.
  - Inspect `ok/sent/recv/mismatch/timeout/kbps` per baud.

## Record 2026-02-14-05
- Date: 2026-02-14
- Executor: Codex
- Scope: MCU/GUI coordinated baud-step handshake test (115200 -> up to 4Mbps)
- Related files:
  - `src/app/uart_dma/uart_dma_port.h`
  - `src/app/uart_dma/uart_dma_port.c`
  - `src/app/uart_dma/uart_dma_demo.c`
  - `tools/UartRateTester/uart_rate_tester.py`
  - `tools/UartRateTester/README.md`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - User requested both MCU and PC support for commanded baud switching and upper-limit error-rate test.
- Risk assessment:
  - Medium: runtime baud switching may fail on specific baud values depending on clock divider limits.
  - Low: changes are in app/tool layer, no non-user `smc_gen` region modification.
- Validation evidence:
  - 2026-02-14: `ccrx ... src/app/uart_dma/uart_dma_port.c` -> PASS
  - 2026-02-14: `ccrx ... src/app/uart_dma/uart_dma_demo.c` -> PASS
  - 2026-02-14: `python -m py_compile tools/UartRateTester/uart_rate_tester.py` -> PASS
- Test instructions:
  - MCU boots at 115200 and responds to `@PING`.
  - GUI sends `@SETBAUD:<rate>` from current baud and waits for `@READY:<rate>` on new baud.
  - GUI then runs packet echo stress and records mismatch/timeout and kbps for each baud.

## Record 2026-02-15-06
- Date: 2026-02-15
- Executor: Codex
- Scope: UART GUI process-visualization enhancement
- Related files:
  - `tools/UartRateTester/uart_rate_tester.py`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - User requested a visible GUI process to observe test stages and progress in real time.
- Risk assessment:
  - Low: host-side GUI enhancement only; no MCU firmware or `smc_gen` impact.
- Validation evidence:
  - 2026-02-15: `python -m py_compile tools/UartRateTester/uart_rate_tester.py` -> PASS
- Test instructions:
  - Run `tools/UartRateTester/run_uart_rate_tester.bat`.
  - Select COM port and baud candidates.
  - Click `Start Scan` and verify:
    - Phase switches among `Handshake`, `Switch Baud`, `Stress Test`.
    - Progress bar increases to 100%.
    - Detail shows packet progress (`pkt x/y`) during stress test.

## Record 2026-02-15-07
- Date: 2026-02-15
- Executor: Codex
- Scope: GUI "all fail" root-cause fix
- Related files:
  - `tools/UartRateTester/uart_rate_tester.py`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - User reported all test cases failed in GUI scan.
- Root cause:
  - Handshake decision used string truthiness (`if not boot["ok"]`), causing `"N"` path not to stop scan.
  - Handshake/switch ack logic read single line only and was vulnerable to banner/noise timing.
- Risk assessment:
  - Low: host test tool only; no firmware and no `smc_gen` change.
- Validation evidence:
  - 2026-02-15: `python -m py_compile tools/UartRateTester/uart_rate_tester.py` -> PASS
- Test instructions:
  - Re-run GUI scan at `115200` only first; confirm handshake row becomes `ok=Y`.
  - Then add higher bauds incrementally and observe first failing baud and note text.

## Record 2026-02-15-08
- Date: 2026-02-15
- Executor: Codex
- Scope: UART GUI CSV export and auto-save
- Related files:
  - `tools/UartRateTester/uart_rate_tester.py`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - User requested to continue with practical validation workflow and traceable outputs.
- Risk assessment:
  - Low: host-side test utility enhancement only.
- Validation evidence:
  - 2026-02-15: `python -m py_compile tools/UartRateTester/uart_rate_tester.py` -> PASS
- Test instructions:
  - Run GUI and execute a scan.
  - Verify auto-generated CSV under `tools/UartRateTester/results/`.
  - Optionally click `Export CSV` to save to custom path.

## Record 2026-02-15-09
- Date: 2026-02-15
- Executor: Codex
- Scope: GUI command framing bug fix
- Related files:
  - `tools/UartRateTester/uart_rate_tester.py`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - User reported issue still persisted after previous fixes.
- Root cause:
  - Host tool sent literal `\\n` bytes in commands, so MCU command parser never saw line termination.
- Fix:
  - Replaced `@PING\\n` -> `@PING\n`
  - Replaced `@SETBAUD:<rate>\\n` -> `@SETBAUD:<rate>\n`
- Validation evidence:
  - 2026-02-15: `python -m py_compile tools/UartRateTester/uart_rate_tester.py` -> PASS

## Record 2026-02-15-10
- Date: 2026-02-15
- Executor: Codex
- Scope: Intermittent test failure root-cause fix (MCU RX buffering + host sync)
- Related files:
  - `src/app/common/app_types.h`
  - `src/app/uart_dma/uart_dma_port.c`
  - `src/app/uart_dma/uart_dma_demo.c`
  - `tools/UartRateTester/uart_rate_tester.py`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - User reported unstable behavior ("sometimes good, sometimes bad"), and requested direct agent-side testing.
- Root cause summary:
  - MCU RX used one-byte mailbox + flag; bytes could be overwritten before main loop consumed them.
  - Host tests could desynchronize MCU command parser when previous command line was incomplete.
  - Some test payload patterns could interfere with demo command channel semantics.
- Fix:
  - Implemented RX ring buffer in ISR path and pop in `uart_dma_port_try_get_rx_byte`.
  - Added `rx_overrun_count` diagnostics.
  - Added handshake pre-sync newline in GUI.
  - Constrained GUI stress payload to command-safe bytes.
- Validation evidence:
  - 2026-02-15: `make all` in `HardwareDebug` -> PASS
  - 2026-02-15: `python -m py_compile tools/UartRateTester/uart_rate_tester.py` -> PASS
  - 2026-02-15: auto GDB download attempt blocked by emulator occupancy (`The specified emulator has already been used`).

## Record 2026-02-15-11
- Date: 2026-02-15
- Executor: Codex
- Scope: Direct agent-side UART rate stress test and GUI switch-criteria refinement
- Related files:
  - `tools/UartRateTester/uart_rate_tester.py`
  - `tools/UartRateTester/results/agent_cli_scan_20260215_004135.csv`
  - `tools/UartRateTester/results/agent_cli_scan_resync_20260215_004341.csv`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - User requested direct autonomous testing due unstable GUI observations.
- Test result summary:
  - Stable pass at `115200/230400/460800/921600` (multiple runs, zero mismatch/timeout).
  - Fails when switching to `1000000` (`ping_new_fail`), indicating current baud-generation strategy limit.
- Improvement:
  - GUI baud switch success now allows `ACK + ping @ new baud` fallback even when `@READY` frame is missed.
- Validation evidence:
  - 2026-02-15: `python -m py_compile tools/UartRateTester/uart_rate_tester.py` -> PASS

## Record 2026-02-15-12
- Date: 2026-02-15
- Executor: Codex
- Scope: MCU high-baud adaptation algorithm optimization
- Related files:
  - `src/app/uart_dma/uart_dma_port.c`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - Previous runtime baud algorithm used a fixed divisor model and failed at >=1Mbps.
- Fix summary:
  - Added SCI baud mode search table across SMR/SEMR combinations.
  - Runtime selects minimum baud error candidate and programs `SMR/SEMR/BRR`.
  - Added maximum baud error threshold (`UART_DMA_BAUD_ERR_MAX_PERMILLE`) for reject path.
- Risk assessment:
  - Medium: runtime changes now touch both `SMR` and `SEMR`; invalid assumptions on divisor model may affect some baud points.
- Validation evidence:
  - 2026-02-15: `make all` in `HardwareDebug` -> PASS
  - 2026-02-15: auto download script attempt blocked by debugger occupancy (`The specified emulator has already been used`).

## Record 2026-02-15-13
- Date: 2026-02-15
- Executor: Codex
- Scope: Post-update direct rate-limit validation (agent autonomous run)
- Related files:
  - `tools/UartRateTester/results/agent_cli_scan_after_baud_algo_20260215_005400.csv`
  - `docs/CHANGE_RECORDS.md`
- Test configuration:
  - Port: `COM3`
  - Packet payload: `128 bytes`
  - Packets per baud: `300`
  - Runs: `3`
  - Baud sweep: `115200 -> 230400 -> 460800 -> 921600 -> 1000000 -> 1500000 -> 2000000 -> 3000000 -> 4000000`
- Result summary:
  - Stable PASS: `115200`, `230400`, `460800`, `921600`, `1000000`, `1500000`, `2000000`
  - Stable FAIL: switch to `3000000` (`ping_new_fail`, non-ASCII garbage response)
  - `4000000` not reached due `3000000` gate failure.
- Conclusion:
  - New baud adaptation algorithm successfully removed previous `1Mbps` barrier and extended stable operation up to `2Mbps` under current hardware setup.

## Record 2026-02-15-14
- Date: 2026-02-15
- Executor: Codex
- Scope: Descending baud stability/loss scan tool and 2.5M-first test run
- Related files:
  - `tools/UartRateTester/uart_desc_loss_scan.py`
  - `tools/UartRateTester/results/desc_100k_scan_20260215_011437.csv`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - User requested high-to-low scan from default `2.5Mbps` with `100k` cadence.
- Validation evidence:
  - 2026-02-15: `python -m py_compile tools/UartRateTester/uart_desc_loss_scan.py` -> PASS
  - 2026-02-15: `python tools/UartRateTester/uart_desc_loss_scan.py --port COM3 --start 2500000 --end 100000 --step 100000 --packets 200 --payload 128 --timeout 0.02` -> completed
- Result summary:
  - This run did not establish a stable echo session at any baud step (all packet loss = 100% in current session context).
  - Indicates runtime mode/channel state mismatch rather than single-point baud capability conclusion.

## Record 2026-02-15-15
- Date: 2026-02-15
- Executor: Codex
- Scope: Re-test after user confirmation ("ready") for 2.5Mbps and descending 100k scan
- Related files:
  - `tools/UartRateTester/results/desc_100k_scan_20260215_012747.csv`
  - `docs/CHANGE_RECORDS.md`
- Commands executed:
  - 2.5Mbps fixed-point stress: `2000 packets x 128 bytes`
  - Descending scan: `2500000 -> 100000`, step `100000`, `150 packets x 128 bytes` per baud
- Result summary:
  - 2.5Mbps fixed-point: packet loss `100%`, byte loss `100%` (timeout from packet 0).
  - Descending scan: all baud points packet loss `100%` in this runtime session.
  - Some baud points returned partial/garbled bytes, indicating baud/domain mismatch rather than a stable echo channel.
- Conclusion:
  - Current board runtime is not in a deterministic testable echo state; baud-rate capability cannot be inferred from this run alone.

## Record 2026-02-15-16
- Date: 2026-02-15
- Executor: Codex
- Scope: User-requested 2Mbps re-test after runtime reconfiguration
- Related files:
  - `tools/UartRateTester/results/agent_2m_retest_20260215_013332.csv`
  - `docs/CHANGE_RECORDS.md`
- Test configuration:
  - Port: `COM3`
  - Baud: `2000000`
  - Payload: `128 bytes`
  - Packets: `3000`
- Result summary:
  - `ok=3000`, `fail=0`, `timeout=0`, `mismatch=0`
  - Packet loss rate: `0.000000%`
  - Byte loss rate: `0.000000%`
  - Throughput: `61.127 kbps` (current test method, single packet transaction loop)

## Record 2026-02-15-17
- Date: 2026-02-15
- Executor: Codex
- Scope: Ascending 100k-step scan from 2Mbps
- Related files:
  - `tools/UartRateTester/results/asc_100k_scan_20260215_013630.csv`
  - `docs/CHANGE_RECORDS.md`
- Test configuration:
  - Port: `COM3`
  - Scan: `2000000 -> 4000000`, step `100000`
  - Per-baud stress: `1000 packets x 128 bytes`
- Result summary:
  - `2000000`: pass (`0%` packet/byte loss)
  - `2100000`: switch failed (`ping_new_fail`), scan stopped
- Conclusion:
  - Under current setup, stable operating point remains at `2.0Mbps`; first failing step observed at `2.1Mbps`.

## Record 2026-02-15-18
- Date: 2026-02-15
- Executor: Codex
- Scope: MCU autonomous baud sweep command implementation
- Related files:
  - `src/app/uart_dma/uart_dma_demo.c`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - User requested MCU-side automatic 100k-step baud progression from current default.
- Implementation summary:
  - Added autosweep command set:
    - `@AUTOSWEEP:START,END,STEP,MS`
    - `@AUTOSWEEP:STOP`
    - `@AUTOSWEEP:STATUS`
  - Added runtime sweep state machine and interval-driven baud stepping in main loop.
  - Added sweep status output frames (`@SWEEP:SET/OK/ERR/DONE`).
- Validation evidence:
  - 2026-02-15: `make all` in `HardwareDebug` -> PASS

## Record 2026-02-15-19
- Date: 2026-02-15
- Executor: Codex
- Scope: MCU autosweep runtime follow-up validation (host synchronized follow)
- Related files:
  - `tools/UartRateTester/results/autosweep_follow_from_115200_20260215_014445.csv`
  - `tools/UartRateTester/results/autosweep_follow_windowed_20260215_014543.csv`
  - `docs/CHANGE_RECORDS.md`
- Test setup:
  - MCU command: `@AUTOSWEEP:2000000,2500000,100000,1200` (and windowed variant at 1500ms)
  - Host follows each target baud and executes short echo stress test.
- Observed result pattern:
  - Reachable+stable: `2.1M`, `2.2M`, `2.3M`, `2.5M` (all tested packets pass)
  - Not reached in host-follow window: `2.0M`, `2.4M` (ping timeout in this capture)
- Notes:
  - Autosweep mode is active and switching occurred (multiple high-speed points validated).
  - Missing points likely due sweep timing/actual baud quantization mismatch, requires tighter host synchronization or MCU-side sweep hold/report enhancement for deterministic per-step capture.

## Record 2026-02-15-20
- Date: 2026-02-15
- Executor: Codex
- Scope: Deterministic host-driven high-baud re-validation up to 4Mbps
- Related files:
  - `tools/UartRateTester/results/asc_100k_host_deterministic_20260215_014834.csv`
  - `tools/UartRateTester/results/pointwise_2m_to_4m_20260215_015021.csv`
  - `docs/CHANGE_RECORDS.md`
- Test methods:
  - Method A: 100k ascending scan with strict host `SETBAUD->PING->STRESS` flow.
  - Method B: pointwise independent test for each baud from `2.0M` to `4.0M` (recover to `2.0M` before each target).
- Key results:
  - Stable pass at `2.0M` (`0%` packet loss in both methods).
  - Method A first failure at `2.1M` (`ping_new_fail`).
  - Method B found another stable point at `2.4M` (`0%` packet loss), while many neighboring points failed command-level handshake.
- Interpretation:
  - High-baud validity is non-monotonic under current clock/line condition; some discrete baud points are viable while adjacent points are not.

## Record 2026-02-15-21
- Date: 2026-02-15
- Executor: Codex
- Scope: Stable-point scan tool addition and runtime availability check
- Related files:
  - `tools/UartRateTester/uart_stable_point_scan.py`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - User requested to continue with systematic stable-point discovery.
- Validation evidence:
  - 2026-02-15: `python -m py_compile tools/UartRateTester/uart_stable_point_scan.py` -> PASS
  - 2026-02-15: tool execution attempted; failed precondition (`current_baud=None`)
  - 2026-02-15: fallback probe over `100k..4M` reported `NOT_FOUND`
- Conclusion:
  - MCU is not currently in command-responsive runtime state; further automated sweep requires user-side reset/resume first.

## Record 2026-02-16-22
- Date: 2026-02-16
- Executor: Codex
- Scope: UART-DMA firmware full protocol completion (ASCII + BIN dual-mode)
- Related files:
  - `src/app/common/app_types.h`
  - `src/app/uart_dma/uart_dma_port.h`
  - `src/app/uart_dma/uart_dma_port.c`
  - `src/app/uart_dma/uart_dma_demo.c`
  - `tools/UartRateTester/uart_frame_tester.py`
  - `tools/UartRateTester/README.md`
  - `docs/MIDDLEWARE_FLOW_UART_DMA.md`
  - `CHANGELOG.md`
  - `docs/CHANGE_RECORDS.md`
- Reason:
  - User requested to continue implementing complete functionality and align coding/algorithm workflow with Renesas full-solution style.
  - Mapped current project from MVP echo/line-command mode to manager-like dual-mode control path (state machine + framed protocol + diagnostics).
- Implementation summary:
  - Added BIN frame protocol (`A5 5A LEN CMD SEQ PAYLOAD CRC16`) with parser state machine and resync.
  - Added runtime protocol mode switch:
    - `@PROTO:BIN`
    - `@PROTO:ASCII`
    - `@PROTO:STATUS`
  - Implemented BIN command set:
    - `PING`
    - `GET_BAUD`
    - `SET_BAUD`
    - `GET_STATS`
    - `CLEAR_STATS`
    - `ECHO_CTRL`
    - `BURST_TX`
    - `AUTOSWEEP_SET`
    - `AUTOSWEEP_STOP`
    - `AUTOSWEEP_STATUS`
    - `MODE_SET`
    - `RAW_ECHO`
  - Extended diagnostics with protocol counters and added event-report API at port layer.
  - Added host-side binary protocol tester script for deterministic BIN validation.
- Risk assessment:
  - Medium: protocol mode switch adds new runtime branch; host scripts must select proper mode before binary commands.
  - Low: no `smc_gen` modification in this change; hardware driver bridge remains unchanged.
- Validation evidence:
  - 2026-02-16 11:06: `ccrx -nologo -isa=rxv3 -lang=c99 -output=obj ... src/app/uart_dma/uart_dma_demo.c` -> PASS
  - 2026-02-16 11:06: `ccrx -nologo -isa=rxv3 -lang=c99 -output=obj ... src/app/uart_dma/uart_dma_port.c` -> PASS
  - 2026-02-16 11:06: `ccrx -nologo -isa=rxv3 -lang=c99 -output=obj ... src/RX26TFADFM_UART_DMA_Motor.c` -> PASS
  - 2026-02-16 11:07: `python -m py_compile tools/UartRateTester/uart_frame_tester.py` -> PASS
  - 2026-02-16 11:07: `python -m py_compile tools/UartRateTester/uart_rate_tester.py` -> PASS
  - 2026-02-16 11:07: `python -m py_compile tools/UartRateTester/uart_desc_loss_scan.py` -> PASS
  - 2026-02-16 11:07: `python -m py_compile tools/UartRateTester/uart_stable_point_scan.py` -> PASS
